{% extends 'base.html' %}
{% block title %}Updates – MS11{% endblock %}
{% block content %}
<section class="space-y-4">
  <h1 class="text-xl font-semibold">Updates</h1>
  <div class="rounded-xl ring-1 ring-neutral-800 bg-neutral-900/60 p-4">
    <div id="verInfo" class="text-sm text-neutral-300">Checking versions…</div>
    <div class="mt-3">
      <button id="btnCheck" class="px-3 py-2 rounded-md bg-neutral-800 ring-1 ring-neutral-700">Check for Updates</button>
      <button id="btnUpdate" class="px-3 py-2 rounded-md bg-primary-600 ring-1 ring-primary-700 text-white">Update All</button>
    </div>
  </div>
</section>
<script>
  async function refresh(){
    const r = await fetch('/api/updates'); const j = await r.json();
    document.getElementById('verInfo').textContent = `Current: ${j.current||'?'} • Latest: ${j.latest||'?'} ${j.updateAvailable? '• Update available':''}`;
  }
  document.getElementById('btnCheck').addEventListener('click', refresh);
  document.getElementById('btnUpdate').addEventListener('click', async ()=>{ await fetch('/api/updates/apply', {method:'POST'}); refresh(); });
  document.addEventListener('DOMContentLoaded', refresh);
</script>
{% endblock %}


